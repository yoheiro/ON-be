(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{378:function(e,t,o){var content=o(444);"string"==typeof content&&(content=[[e.i,content,""]]),content.locals&&(e.exports=content.locals);(0,o(23).default)("fdcbb746",content,!0,{sourceMap:!1})},443:function(e,t,o){"use strict";o(378)},444:function(e,t,o){(t=o(22)(!1)).push([e.i,"#my-video[data-v-bbf11844]{transform:rotateY(180deg);max-width:100%;border-radius:10px;border:3px solid #6091d3}.my-info-card[data-v-bbf11844],.my-video-object[data-v-bbf11844]{position:relative;display:flex;flex-direction:column}.my-info[data-v-bbf11844]{z-index:10;width:100%}.my-info[data-v-bbf11844],.my-info-close[data-v-bbf11844]{position:absolute;text-align:right;right:3px}.my-info-close[data-v-bbf11844]{z-index:100}.partner-video[data-v-bbf11844]{max-width:100%;border-radius:10px;border:3px solid #6091d3}.my-info-card[data-v-bbf11844]{width:90vw;border-radius:10px}",""]),e.exports=t},467:function(e,t,o){"use strict";o.r(t);o(28),o(13),o(221),o(56),o(219),o(70);var n=o(17),r=o(442),c=o.n(r),l=o(126),d={data:function(){return{APIKey:"f0380daa-b6a9-43c6-b015-249eb77f026f",selectedAudio:"",selectedVideo:"",audios:[],videos:[],localStream:null,peerId:"",roomId:"1234",remoteStreams:[],roomOpened:!1,messages:[],myInfo:{},myInfoOverlay:!1,disableMyInfo:!1}},created:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var o;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,navigator.mediaDevices.getUserMedia({video:!0,audio:!0});case 2:return e.peer=new c.a({key:e.APIKey,debug:3}),t.next=5,navigator.mediaDevices.enumerateDevices();case 5:(o=t.sent).filter((function(e){return"audioinput"===e.kind})).map((function(audio){return e.audios.push({text:audio.label||"Microphone ".concat(e.audios.length+1),value:audio.deviceId})})),o.filter((function(e){return"videoinput"===e.kind})).map((function(video){return e.videos.push({text:video.label||"Camera  ".concat(e.videos.length-1),value:video.deviceId})}));case 8:case"end":return t.stop()}}),t)})))()},methods:{onChange:function(){""!==this.selectedAudio&&""!==this.selectedVideo&&this.connectLocalCamera()},connectLocalCamera:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){var o,n;return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return o={audio:!!e.selectedAudio&&{deviceId:{exact:e.selectedAudio}},video:!!e.selectedVideo&&{deviceId:{exact:e.selectedVideo}}},t.next=3,navigator.mediaDevices.getUserMedia(o);case 3:n=t.sent,document.getElementById("my-video").srcObject=n,e.localStream=n;case 6:case"end":return t.stop()}}),t)})))()},leaveRoom:function(){this.peer.open&&(this.roomOpened=!1,this.remoteStreams=[],this.room.close())},joinRoom:function(){var e=this;this.peer.open&&(this.roomOpened=!0,this.room=this.peer.joinRoom(this.roomId,{mode:"sfu",stream:this.localStream}),this.room.once("open",(function(){e.messages.push("=== You joined ===")})),this.room.on("peerJoin",(function(t){e.messages.push("=== ".concat(t," joined ==="))})),this.room.on("stream",function(){var t=Object(n.a)(regeneratorRuntime.mark((function t(o){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.remoteStreams.push(o);case 2:console.log("リモートストリーム"),console.log(e.remoteStreams);case 4:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),this.room.on("data",(function(t){var data=t.data,o=t.src;e.messages.push("".concat(o,": ").concat(data))})),this.room.on("peerLeave",(function(t){var o=e.remoteStreams.findIndex((function(e){return e.peerId===t}));e.remoteStreams.splice(o,1),e.messages.push("=== ".concat(t," left ==="))})),this.room.once("close",(function(){e.messages.length=0})))},getMyData:function(){var e=this;return Object(n.a)(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l.a.firestore().collection("users").doc("4w7Q9B9ziaPjVQnsniQftUhMoIF3").get().then((function(e){return e.data()}));case 2:e.myInfo=t.sent;case 3:case"end":return t.stop()}}),t)})))()},showMyInfo:function(){var e=this;this.disableMyInfo=!this.disableMyInfo,this.getMyData().then((function(){e.myInfoOverlay=!e.myInfoOverlay}))},closeMyInfo:function(){this.myInfoOverlay=!this.myInfoOverlay,this.disableMyInfo=!this.disableMyInfo},cameraEnabled:function(){var e=this.localStream.getVideoTracks()[0];console.log(e),e.enabled=!e.enabled},audioEnabled:function(){console.log(this.localStream.getAudioTracks());var e=this.localStream.getAudioTracks()[0];e.enabled=!e.enabled,console.log(e.enabled)},test:function(){console.log(this.$refs.AudioSelecter)}}},v=(o(443),o(46)),m=o(55),f=o.n(m),h=o(329),y=o(315),_=o(316),I=o(342),x=o(368),w=o(314),k=o(305),V=o(379),O=o(345),M=o(326),j=o(360),C=o(344),A=o(370),component=Object(v.a)(d,(function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[e._v("\n  "+e._s(e.messages)+"\n  "),o("v-row",{attrs:{justify:"center",align:"center"}},[o("v-col",{attrs:{cols:"6"}},[o("div",{staticClass:"my-video-object"},[o("video",{attrs:{id:"my-video",muted:"true",autoplay:"",playsinline:""},domProps:{muted:!0}}),e._v(" "),o("div",{staticClass:"my-info"},[o("v-icon",{attrs:{disabled:e.disableMyInfo,size:"20px"},on:{click:e.showMyInfo}},[e._v("mdi-information-outline")])],1),e._v(" "),o("v-overlay",{attrs:{value:e.myInfoOverlay,dark:!1}},[o("v-card",{staticClass:"my-info-card"},[o("v-btn",{staticClass:"my-info-close",attrs:{fab:"",small:""},on:{click:e.closeMyInfo}},[o("v-icon",[e._v("mdi-close")])],1),e._v(" "),o("v-list",[o("v-list-item",[o("v-list-item-icon",{staticClass:"ml-3"},[o("v-avatar",[o("img",{attrs:{src:e.myInfo.userIcon}})])],1),e._v(" "),o("v-list-item-content",[e._v("\n                  "+e._s(e.myInfo.userName)+"\n                ")])],1),e._v(" "),o("v-list-item",[o("v-list-item-content",[o("v-list-item-title",{staticClass:"ml-3",staticStyle:{"text-align":"left"}},[e._v("自己紹介文")]),e._v(" "),o("p",[e._v(e._s(e.myInfo.profile))])],1)],1)],1)],1)],1)],1)]),e._v(" "),o("v-col",{attrs:{cols:"6"}},[o("v-list",[o("v-list-item",[e._v("kaji")]),e._v(" "),o("v-list-item",[e._v("静岡大学")])],1)],1)],1),e._v(" "),o("v-divider"),e._v(" "),o("v-row",[e._l(e.remoteStreams,(function(e,t){return o("v-col",{key:t,attrs:{cols:"6"}},[o("div",[o("video",{staticClass:"partner-video",attrs:{autoplay:"",playsinline:""},domProps:{srcObject:e}})])])})),e._v(" "),!1===e.roomOpened?o("button",{staticClass:"button--green",on:{click:e.joinRoom}},[e._v("\n      Join\n    ")]):e._e(),e._v(" "),o("br")],2),e._v(" "),o("input",{directives:[{name:"model",rawName:"v-model",value:e.roomId,expression:"roomId"}],attrs:{type:"text",placeholder:"Room Name"},domProps:{value:e.roomId},on:{input:function(t){t.target.composing||(e.roomId=t.target.value)}}}),e._v(" "),o("p",[e._v("\n    ROOM ID: "),o("span",{attrs:{id:"room-id"}},[e._v(e._s(e.roomId))])]),e._v(" "),o("div",[e._v("\n    カメラ:\n    "),o("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedVideo,expression:"selectedVideo"}],ref:"AudioSelecter",on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedVideo=t.target.multiple?o:o[0]},e.onChange]}},[o("option",{attrs:{disabled:"",value:""}},[e._v("Please select one")]),e._v(" "),e._l(e.videos,(function(video,t,n){return o("option",{key:n,domProps:{value:video.value}},[e._v("\n        "+e._s(video.text)+"\n      ")])}))],2)]),e._v("\n  マイク:\n  "),o("select",{directives:[{name:"model",rawName:"v-model",value:e.selectedAudio,expression:"selectedAudio"}],on:{change:[function(t){var o=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){return"_value"in e?e._value:e.value}));e.selectedAudio=t.target.multiple?o:o[0]},e.onChange]}},[o("option",{attrs:{disabled:"",value:""}},[e._v("Please select one")]),e._v(" "),e._l(e.audios,(function(audio,t,n){return o("option",{key:n,domProps:{value:audio.value}},[e._v("\n      "+e._s(audio.text)+"\n    ")])}))],2),e._v(" "),o("v-bottom-navigation",{attrs:{fixed:""}},[o("v-btn",{on:{click:e.audioEnabled}},[o("span",[e._v("オーディオ")]),e._v(" "),o("v-icon",[e._v("mdi-microphone")])],1),e._v(" "),o("v-btn",{on:{click:e.cameraEnabled}},[o("span",[e._v("カメラ")]),e._v(" "),o("v-icon",[e._v("mdi-camera")])],1),e._v(" "),o("v-btn",{on:{click:e.leaveRoom}},[o("span",[e._v("退出")]),e._v(" "),o("v-icon",[e._v("mdi-door")])],1)],1)],1)}),[],!1,null,"bbf11844",null);t.default=component.exports;f()(component,{VAvatar:h.a,VBottomNavigation:y.a,VBtn:_.a,VCard:I.a,VCol:x.a,VDivider:w.a,VIcon:k.a,VList:V.a,VListItem:O.a,VListItemContent:M.a,VListItemIcon:j.a,VListItemTitle:M.b,VOverlay:C.a,VRow:A.a})}}]);